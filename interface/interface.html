<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" integrity="sha512-aOG0c6nPNzGk+5zjwyJaoRUgCdOrfSDhmMID2u4+OIslr0GjpLKo7Xm0Ao3xmpM4T8AmIouRkqwj1nrdVsLKEQ==" crossorigin="anonymous" />
<!--     <script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script> -->
    <script src="https://mozilla.github.io/pdf.js/build/pdf.js"></script>



    <!-- Include DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.25/datatables.min.css"/>

    <!-- Include DataTables JS -->
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.25/datatables.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$', '$'], ['$ ', ' $'], ['$$ ', ' $$'], ['$$', '$$'], ['\\(', '\\)']],
            processEscapes: true
          }
        });
    </script>

    <!-- Bootstrap CSS -->
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css" integrity="sha512-rt/SrQ4UNIaGfDyEXZtNcyWvQeOq0QLygHluFQcSjaGB04IxWhal71tKuzP6K8eYXYB6vJV4pHkXcmFGGQ1/0w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.bundle.min.js" integrity="sha512-igl8WEUuas9k5dtnhKqyyld6TzzRjvMqLC79jkgT3z02FvJyHAuUtyemm/P/jYSne1xwFI06ezQxEwweaiV7VA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="interface/style.css">

    <title>Document Index Interface</title>
</head>
<body>
    
    <div id="loader">
      <h1>Give us a few seconds to load stuff ... </h1>
      <h1>Page will be loaded in 5 seconds on fast wifi connections ... </h1>
      <h1>This is an experimental tool and is not optimised ... </h1>
    </div>
    <div class="container-fluid">
    
        <div class="row scrolling-row">
            <div class="col-2 sidebar sticky-top scrollable-sidebar" id="doc-keys-sidebar">
              <div class="d-flex justify-content-between align-items-center mt-2">
                <button class="btn btn-primary" id="hide-sidebar"><i class="fa fa-bars"></i></button>
                <input type="text" id="searchBox" class="form-control ml-2" style="background-color: #f5f5f5;" placeholder="Search your docs">
                <button id="add-document-button" type="button" class="btn btn-primary ml-2"><i class="fa fa-plus"></i></button>
              </div>
            

                <h4>Documents</h4>
                <div id="documents" class="list-group">
                    <!-- List of documents will be populated here -->
                </div>
                </br>
                <h4>API Keys</h4>
                <label for="allKeysAsJson">All Keys as JSON Dict</label>
                <div class="input-group">
                  <input type="text" id="allKeysAsJson" class="form-control" placeholder="paste json dict here">
                  <button id="copyButton" class="btn btn-secondary" type="button">
                    <i class="bi bi-clipboard"></i>
                  </button>
                </div>

                <label for="openAIKey">Open-AI API Key</label>
                <input type="text" id="openAIKey" class="form-control">

                <label for="mathpixId">Mathpix API ID</label>
                <input type="text" id="mathpixId" class="form-control">
                
                <label for="mathpixKey">Mathpix API Key</label>
                <input type="text" id="mathpixKey" class="form-control">

                <label for="cohereKey">Cohere API Key</label>
                <input type="text" id="cohereKey" class="form-control">

                <label for="ai21Key">Ai21 API Key</label>
                <input type="text" id="ai21Key" class="form-control">
                
                <label for="bingKey">Bing API Key</label>
                <input type="text" id="bingKey" class="form-control">
    
                <label for="serpApiKey">SERP API Key</label>
                <input type="text" id="serpApiKey" class="form-control">
    
                <label for="googleSearchApiKey">Google Custom Search API Key</label>
                <input type="text" id="googleSearchApiKey" class="form-control">
                <label for="googleSearchCxId">Google Custom Search Engine id (cx)</label>
                <input type="text" id="googleSearchCxId" class="form-control">

                <label for="scrapingBrowserUrl">Scraping browser Url <a href="https://help.brightdata.com/hc/en-us/articles/13362921219729-Getting-started-with-Scraping-Browser"> See this.</a> Example: "https://brd-customer-hl_f6ac9ba2-zone-scraping_browser:p42yduf8gfzf@brd.superproxy.io:9222"</label>
                <input type="text" id="scrapingBrowserUrl" class="form-control" placeholder="Looks like `https://<bright-customer-id>:<password>@brd.superproxy.io:9222`">
    
            
                </br>
            </div>

            <div class="col-10" id="content-col">
                <ul class="nav nav-tabs" id="pdf-details-tab" role="tablist">
                  <li class="nav-item">
                      <a class="nav-link" id="show-sidebar" href="#" style="display:none;"><i class="fa fa-bars"></i></a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link active" id="pdf-tab" data-toggle="tab" href="#pdf-content" role="tab">PDF</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="hide-navbar" href="#">Show only PDF</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" id="details-tab" data-toggle="tab" href="#details-content" role="tab">Cites & Refs </a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" id="assistant-tab" href="#assistant-view" data-toggle="tab" role="tab">Chat Assistant</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="review-assistant-tab" data-toggle="tab" role="tab" href="#review-content">Review</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" id="toggle-tab-content" href="#"><i class="bi bi-caret-up-fill"> Hide PDF</i> <i class="bi bi-caret-down-fill"> Show PDF</i></a>
                  </li>
                  
                  
                  <li class="nav-item ml-auto">
                      <a class="nav-link" id="logout-link" href="#">
                          Logged in as <span id="username">Loading...</span>, Click here to Logout
                      </a>
                  </li>
                </ul>
                <div id="navbar-trigger" style="height: 5px;"></div>
                <div id="references-view">
                  <div class="tab-content">
                    <div class="tab-pane fade" id="details-content" role="tabpanel">
                            <h3>References <button class="btn btn-primary" id="refresh-references">Refresh</button></h3>
                            <table id="references-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ArXiv</th>
                                        <th>Abstract</th>
                                        <th># Citations</th>
                                        <th>Journal</th>
                                        <th>Paper ID</th>
                                        <th>Publication Date</th>
                                        <th>Reference Count</th>
                                        <th>Title</th>
                                        <th>TLDR</th>
                                        <th>URL</th>
                                        <th>Year</th>
                                        <th>Extended Abstract</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>ArXiv</th>
                                        <th>Abstract</th>
                                        <th># Citation</th>
                                        <th>Journal</th>
                                        <th>Paper ID</th>
                                        <th>Publication Date</th>
                                        <th>Reference Count</th>
                                        <th>Title</th>
                                        <th>TLDR</th>
                                        <th>URL</th>
                                        <th>Year</th>
                                        <th>Extended Abstract</th>
                                    </tr>
                                </tfoot>
                            </table>

                            <h3>Citations <button class="btn btn-primary" id="refresh-citations">Refresh</button></h3>
                            <table id="citations-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ArXiv</th>
                                        <th>Abstract</th>
                                        <th># Citation</th>
                                        <th>Journal</th>
                                        <th>Paper ID</th>
                                        <th>Publication Date</th>
                                        <th>Reference Count</th>
                                        <th>Title</th>
                                        <th>TLDR</th>
                                        <th>URL</th>
                                        <th>Year</th>
                                        <th>Extended Abstract</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>ArXiv</th>
                                        <th>Abstract</th>
                                        <th># Citation</th>
                                        <th>Journal</th>
                                        <th>Paper ID</th>
                                        <th>Publication Date</th>
                                        <th>Reference Count</th>
                                        <th>Title</th>
                                        <th>TLDR</th>
                                        <th>URL</th>
                                        <th>Year</th>
                                        <th>Extended Abstract</th>
                                    </tr>
                                </tfoot>
                            </table>
                    </div>
                  </div>
                </div>
                <div id="review-assistant-view">
                  <div class="tab-content">
                    <div class="tab-pane fade" id="review-content" role="tabpanel">
                      <div class="row"><div class="col-md-12" id="write_review"></div></div>
                      <div class="row">
                        <div class="col-md-12" id="show_reviews"></div>
                      </div>
                    </div>
                    
                  </div>
                </div>
                <div id="pdf-view">
                    <!-- PDF and details tabs will be displayed here -->
                    
                    <div class="tab-content">

                      <div class="tab-pane fade show active" id="pdf-content" role="tabpanel">
                            <iframe id="pdfjs-viewer" src="interface/pdf.js/web/viewer.html" data-original-src="interface/pdf.js/web/viewer.html" width="100%" height="100%" allowfullscreen webkitallowfullscreen></iframe>
                            <!-- PDF will be displayed here -->
                            <div id="progress" style="display: none;">
                                <div id="progressbar" class="progress-bar" role="progressbar" style="width: 0%;"></div>
                            </div>
                            <span id="progress-status"></span>
                        <div id="pdf-questions">
                          <div id="ask-questions-view" class="view">
                            <!-- Ask questions view will be built here -->
                          </div>
                          <div id="view-details-view" class="view">
                              <!-- Document details view will be built here -->
                          </div>
                          <div id="search-view" class="view">
                              <!-- Document search view will be built here -->
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
                <div id="chat-assistant-view" class="container-fluid" style="padding-left: 2px; padding-top: 2px;">
                  <div class="tab-content">
                    <div class="tab-pane fade show active" id="assistant-view" role="tabpanel">
                      <div class="row scrolling-row">
                        <div class="col-3 sidebar sticky-top scrollable-sidebar" id="chat-assistant-sidebar" style="height: calc(100vh - 55px) !important;">
                            <!-- Sidebar -->
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <button class="btn btn-primary btn-sm" id="hide-chat-sidebar"><i class="fa fa-bars"></i></button>
                                <h4 class="mb-0">Conversations</h4> <!-- Added class mb-0 to remove default bottom margin -->
                                <button id="add-new-chat" type="button" class="btn btn-primary ml-2 btn-sm"><i class="fa fa-plus">&nbsp; New Chat</i></button>
                            </div>
                            <div id="conversations" class="list-group" style="margin-top: 10px;">
                                <!-- Conversations will be dynamically populated here -->
                            </div>
                        </div>
                        <button class="btn btn-primary btn-sm" id="show-chat-sidebar" style="display: none;"><i class="fa fa-bars"></i></button>
                        <div class="col-9" id="chat-assistant">
                          <div id="mainView" class="container-fluid d-flex flex-column vh-100" style="height: calc(100vh - 55px) !important;">
                              <div id="chat-doc-view" class="row">
                                  <!-- Chat Docs will be populated here -->
                                  <button id="add-document-button-chat" type="button" class="btn btn-primary ml-2 mr-2 btn-sm"><i class="fa fa-plus">&nbsp; Add Doc</i></button>

                              </div>
                              <div id="chatView" class="row flex-grow-1 overflow-auto">
                                  <!-- Chat messages will be dynamically populated here -->
                              </div>
                              <div id="chat-controls">
                                <div class="row mb-1"> <!-- Reduced margin bottom -->
                                    <div class="col p-0"> <!-- Removed padding -->
                                        <textarea id="messageText" class="dynamic-textarea form-control" placeholder="Type your message here."></textarea>
                                    </div>
                                    <div class="col p-0"> <!-- Removed padding -->
                                        <textarea id="permanentMessageText" class="dynamic-textarea form-control" placeholder="Custom instructions for this session." style="margin-left: 10px !important;"></textarea>
                                    </div>
                                </div>
                                <div class="row mb-1"> <!-- Reduced margin bottom -->
                                    <div class="col p-0"> <!-- Removed padding -->
                                        <textarea id="linkInput" class="dynamic-textarea form-control" placeholder="Links to Visit, each in a new line"></textarea>
                                    </div>
                                    <div class="col p-0"> <!-- Removed padding -->
                                        <textarea id="searchInput" class="dynamic-textarea form-control" placeholder="Search Phrases, each in a new line" style="margin-left: 10px !important;"></textarea>
                                    </div>
                                </div>
                                <div id="chat-options" class="mt-0 mb-0"> <!-- Removed top and bottom margin -->
                                    
                                </div>
                              </div>
                          </div>
                        </div>
                      
                      
                      
                      
                      </div>
                    </div>
                  </div>
                </div>

                
                
            </div>
        </div>
        
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- Add PDF Document Modal -->
    <div class="modal" tabindex="-1" id="add-document-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Document</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="add-document-form">
                      <div class="form-group">
                        <label for="pdf-url">PDF URL (Note: Indexing takes long time (~2 minute).)</label>
                        <input type="text" class="form-control" id="pdf-url" placeholder="Enter PDF URL">
                        <label>Or drop a PDF file here or<button type="button" id="file-upload-button" style="padding-left: 4px; padding-top:2px;" class="btn btn-link">browse</button></label>
                        <div id="drop-area" style="border: 2px dashed #aaa; padding: 10px; text-align: center;">
                          Drop a PDF file here. To upload MS Word or html, first convert them to PDF.
                        </div>
                        <input type="file" class="form-control-file" id="pdf-file" accept="application/pdf" style="display: none;">
                      </div>
                      
                        <button id="submit-button" type="submit" class="btn btn-primary">Submit</button>
                        <div id="submit-spinner" style="display: none">
                            <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Loading...</span>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Chat Document Modal -->
    <div class="modal" tabindex="-1" id="add-document-modal-chat">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Document</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="add-document-form">
                      <div class="form-group">
                        <label for="pdf-url">PDF URL (Note: Indexing takes long time (~2 minute).)</label>
                        <input type="text" class="form-control" id="pdf-url" placeholder="Enter PDF URL">
                        <label>Or drop a PDF file here or<button type="button" id="file-upload-button" style="padding-left: 4px; padding-top:2px;" class="btn btn-link">browse</button></label>
                        <div id="drop-area" style="border: 2px dashed #aaa; padding: 10px; text-align: center;">
                          Drop a PDF file here. To upload MS Word or html, first convert them to PDF.
                        </div>
                        <input type="file" class="form-control-file" id="pdf-file" accept="application/pdf" style="display: none;">
                      </div>
                      
                        <button id="submit-button" type="submit" class="btn btn-primary">Submit</button>
                        <div id="submit-spinner" style="display: none">
                            <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Loading...</span>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Positive Feedback Modal -->
    <div class="modal fade" id="positive-feedback-modal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Positive Feedback</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="positive-feedback-form">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Relevant" id="positive-relevant">
                <label class="form-check-label" for="positive-relevant">Relevant</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Time-saving" id="positive-time-saving">
                <label class="form-check-label" for="positive-time-saving">Time-saving</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Easy to understand" id="positive-easy">
                <label class="form-check-label" for="positive-easy">Easy to understand</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Correct" id="positive-correct">
                <label class="form-check-label" for="positive-correct">Correct</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Insightful" id="positive-insightful">
                <label class="form-check-label" for="positive-insightful">Insightful</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Comprehensive" id="positive-comprehensive">
                <label class="form-check-label" for="positive-comprehensive">Provides all necessary details</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Well-structured" id="positive-structured">
                <label class="form-check-label" for="positive-structured">Well-structured and Clearly written</label>
              </div>
              <div class="form-group">
                <label for="positive-comments">Additional comments:</label>
                <textarea class="form-control" id="positive-comments" rows="3"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary submit-positive-feedback">Submit Feedback</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Negative Feedback Modal -->
    <div class="modal fade" id="negative-feedback-modal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Negative Feedback</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="negative-feedback-form">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Irrelevant" id="negative-irrelevant">
                <label class="form-check-label" for="negative-irrelevant">Irrelevant</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Incorrect" id="negative-incorrect">
                <label class="form-check-label" for="negative-incorrect">Incorrect</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Too long" id="negative-long">
                <label class="form-check-label" for="negative-long">Too long, complex or dense</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Oversimplified" id="negative-simple">
                <label class="form-check-label" for="negative-simple">Missed important details</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Outdated" id="negative-outdated">
                <label class="form-check-label" for="negative-outdated">Outdated information</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Confusing" id="negative-confusing">
                <label class="form-check-label" for="negative-confusing">Ambiguous/Confusing/Misleading</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Superfluous" id="negative-superfluous">
                <label class="form-check-label" for="negative-superfluous">Superfluous with generic content</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="Badly structured" id="negative-structured">
                <label class="form-check-label" for="negative-structured">Badly structured or formatted</label>
              </div>
              <div class="form-group">
                <label for="negative-comments">Additional comments:</label>
                <textarea class="form-control" id="negative-comments" rows="3"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary submit-negative-feedback">Submit Feedback</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Prevent Rendering Modal -->
    <div class="modal fade" id="prevent-chat-rendering" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            You cannot send a message while the previous message is still rendering. Please wait...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
    <script src="interface/interface.js"></script>
    <script src="interface/chat.js"></script>
</body>
</html>
